\documentclass[a4paper,12pt]{report}

\usepackage{graphicx}
\DeclareGraphicsExtensions{.pdf,.png,.jpg}

\usepackage{wrapfig}

\usepackage{color}
\usepackage{xcolor}
\usepackage{listings}

\usepackage{caption}
\DeclareCaptionFont{white}{\color{white}}
\DeclareCaptionFormat{listing}{\colorbox{gray}{\parbox{\textwidth}{#1#2#3}}}
\captionsetup[lstlisting]{format=listing,labelfont=white,textfont=white}

\lstset{
basicstyle=\small\sffamily,
numbers=left,
numberstyle=\tiny,
frame=tb,
columns=fullflexible,
breaklines=true,
showstringspaces=false
}

\author{Philip Peder Hansen}
\title{Visualisering af funktioner af to variable i Minecraft}

\begin{document}
	\maketitle
	\tableofcontents
	\clearpage
	\section{Funktioner af to variable}
	\subsection{Afbildning af funktioner af to variable}
	\section{Minecraft}
		\emph{Minecraft} er et videospil lavel af \emph{Markus "Notch" Persson}.
		Spillet er en blanding mellem et eventyr overlevelses spil, og et kreativt spil der g\aa r ud p\aa \ at bygge verdener.

		Spilleren har mulighed for at \o del\ae gge blokke, samle dem op, og placere dem tilbage i verdenen.
		Man kan m\o de monstre der sl\aa r p\aa \ en, skyder ild kugler og enda eksplodere, all med form\aa l
		at g\o re det sv\ae rt at overleve.

		I sin kamp mod det onde kan spilleren bygge et sikkert hus, grave efter metaller og smelte disse
		til jern, guld og diamant brynjer og sv\ae re.

		Spillet har ogs\aa \ et element der heder \emph{redstone}, der til en vis grad fungere som ledninger.
		\emph{Redstone} kan brugest til at lave kredsl\o b der automatisere skydning af pile, h\ae ldre lava
		ud over ens fj\ae nder og er enda brugt til at lave \emph{minigames} i \emph{Minecraft}.

		\begin{figure}
			\includegraphics[keepaspectratio = true, scale = 0.2]{screenshot1}
			\caption{En \emph{Minecraft} verden}
		\end{figure}

		Indledene bliver spilleren placeret i en stor verden, der best\aa r af 1 \(m^3\) blokke. Disse blokke har forskellige fysiske egenskaber,
		og bruges i forskellige sammenh\ae nge.

		Derudover genereres blokkene baseret p\aa \ nogle algorytmer, der resultere i et m\o nster der til nogen grad minder
		og den virkelige verden. Tr\ae r genereres i n\ae rheden af hinanden, i skove, og ikke midt ude i havene.
		\O rkner og tundra findes generelt ikke umidelbart i n\ae rheden af hinanden, og floder l\o ber ofte gennem regnskove. 
	\subsection{Generering af verdner}
		Algorytmerne der bruges til at generere verdener i\emph{Minecraft} er en del mere komplicerede end en det simple eksemepel p\aa \ den funktion
		af to parametre vi har kigget p\aa . Ud over \emph{X} og \emph{Z} koordinated bruger minecraft ogs\aa \ noget som kaldes et seed til at generere
		verdener, de genereres alts\aa \ ud fra en mere kompliceret funktion af tre parametre.
		
		\begin{wrapfigure}{r}{0.5\textwidth}
			\includegraphics[keepaspectratio = true, width = 0.5\textwidth]{screenshot2}
			\caption{\emph{Minecraft} verden genererings sk\ae rm}
		\end{wrapfigure}

		Et \emph{seed} er en tekst streng som brugeren kan give \emph{Minecraft} n\aa r en ny verden genereres, hvis brugeren ikke giver denne streng
		bliver den automatisk genereret f\o r verdenen laves. Funktionen af et seed er at selv med den samme verden genererings kode,
		kan vidt forskellige verdener laves.

		Forstil dig for eksempel dette scenarie, vi bruger den f\o lgene formel til at generere en kurve

		\[y = \sin (x)\]

		Denne formel vil altid give en sinus kurve, som vi ogs\aa \ ville forvente det, det passer perfect i matematik, men ikke s\aa \ meget
		hvis vi pr\o ver p\aa \ at lave interesante m\o nstre.

		Forstil dig nu hvis vi \ae ndrede ligningen til at være

		\[y = \sin (seed * x)\]

		S\aa \ l\ae nge \emph{seed} ikke er lig nul, vil denne formel stadig give en sinus kurve, men afh\ae ngligt at hvad vi s\ae tter \emph{seed}
		til at v\ae re, vil perioden for vores kurve v\ae re forskellig.

		P\aa \ samme m\aa de bruger \emph{Minecraft} dette \emph{seed} i generations koden til at skabe verdener der er unikke, p\aa \ trods
		af at de alle er genererede fra den samme kode.

		Ud fra dette seed og generations algorytmerne, bestemmer \emph{Minecraft} hvilken blok der skal placeres p\aa \ hvert punkt
		i verdenen.
	\subsection{Planlægning}
		For at implementere vores egen kode i \emph{Minecraft}, og generere en verden baseret ud fra den f\o lgene funktion, er der
		nogle overvejelser vi f\o rst m\aa \ lave om hvordan dette skal forg\aa .

		

		Den f\o rste, og m\aa ske vigtigste, overvejelse jeg har gjort min i forhold til at implementere denne formel i \emph{Minecraft}
		er hvordan koden skal indkorporeres i spillet.

		Da spillet ikke distribueres som kildekode, er det alts\aa \ ikke muligt bare at skrive koden ind i den orginale kode, og k\o rer spillet.
		Heldigvis findes der en uofficiel API til \emph{Minecraft}, der g\o r det muligt at skrive noget kode som en separat file, som bliver k\o rt
		n\aa r \emph{Minecraft} g\o r det, denne API kaldes \emph{Minecraft Forge}.

		\subsubsection{Forge}
		\emph{Minecraft Forge} eller bare \emph{Forge} fugere p\aa \ den m\aa de at programmet som i sig selv \ae ndre p\aa \ noget af
		kilde koden til \emph{Minecraft}, de \ae ndringer \aa bner op for at andre filer, kendt som \emph{mods}, kan \ae ndre p\aa
		v\ae rdier i spillet, uden direkte at skulle \ae ndre p\aa \ koden. Dette er is\ae r vigtigt da to mods der ville pr\o ve at overskrive
		to forskellige ting i den samme fil, ellers ville overskrive hinandens \ae ndringer, som ville resultere i at kun et mod der havde noget
		at g\o re med en specifik fil ville kunne virke p\aa \ samme tid.

		\subsubsection{Ligning}
		Da vi nu ved at vi kan \ae ndre p\aa \ generations koden i spillet, kan vi kigge tilbage p\aa hvad det egentlig er vi vil implementere.

		Som tidligere n\ae nt best\aa r \emph{Minecraft} verdener af 1 \(m^3\) blokke i et tre dimensionels koordinatsystem. Koordinatsystemet
		er uendeligt bredt og langt, men har en begr\ae nset h\o jde p\aa \ 256 blokke.
		Vores funktion kr\ae ver en del tilpasninger for at blive illustreret vel i dette koordinatsystem.

		Den f\o rste \ae ndring der skal g\o res ved funktinen er at bytte om p\aa \ nogle akser,
		da coordinat systemet i \emph{Minecraft} bryger \emph{Y} aksen som h\o jde, i stedet for \emph{Z} aksen som bruges
		i vores ligning. Den nye funktio ser alts\aa \ s\aa \ ledes ud

		\[y = \cos (x^2) + \sin (z^2)\]

		Denne funtion bruger \emph{XZ} planet som baggrund for at regne højden \emph{Y} ud,
		p\aa \ samme m\aa de som \emph{Minecraft} g\o r det.

		Det n\ae ste problem ved formlen der takles er at sinus og cosinus funktionerne b\ae gge giver et tal mellem -1 og 1.
		Alts\aa \ vil formlen give et resutat mellem -2 og 2 afh\ae ngligt at inputtet, vi kan kun generere blokke mellem
		0 og 256.

		Hvad jeg har valgt at g\o re ved detter at l\ae gge 64 til det endelige resultat af funktionen, hvilket g\o r at resultatet
		nu variere mellem 62 og 66, et niveau vi kan placere blokke i uden problemer.

		\[y = (\cos (x^2) + \sin (z^2)) + 64\]

		Den n\ae ste problemstilling der skal \ae ndres p\aa \ er at resultatet af vores funktion kun variere med 4, p\aa \
		trods af at det er helt accepablet, fungere det ikke helt godt for \emph{Minecraft}, da vi normalt vil have at vores verden
		variere mere end kun 4 blokke op og ned, det giver et meget flat landskab.

		Derfor ganger vi resutatet af sinus og cosinus funktinerne med 32, som giver en variation af 128 blokke (32 * 2 op og 32 * 2 ned).
		Koblet med \ae ndringen om at flytte hele kurven 64 blokke op, betyder det at kurven nu kan g\aa \ fra 0 til 128 i \emph{Y} aksen.

		\[y = ((\cos (x^2) + \sin (z^2)) * 32) + 64\]

		Da vi nu kender den ligning vi vil implementere i \emph{Minecraft}, vil vi forts\ae tte med den rent faktiske implementation af vores
		funktion i spillet.
	\subsection{Implementering}
		\subsubsection{Iteration 1}		
			Det f\o rste trin i at implementere vores generation ind i spillet er at definere et mod.
			Et mod har to hoved komponenter der kræves for at spillet kan genkende det, og k\o rer det.

\begin{lstlisting}[label=srpmod.java,caption=SRPMod.java]
package dk.philiphansen.srpmod;

import net.minecraft.block.Block;
import cpw.mods.fml.common.Mod;

@Mod(modid = SRPMod.MODID, version = SRPMod.VERSION)
public class SRPMod
{
    public static final String MODID = "SRPmod";
    public static final String VERSION = "1.0";
}
\end{lstlisting}
			Denne fil findes af minecraft under opstart, og k\o rers da den har \emph{@mod} annotationen.
			Filen g\o r ikke noget da der ikke rent faktisk er noget kode at eksekvere, bare en fil der definerer at det \emph{mod} findes.

\begin{lstlisting}[label=mcmod.info,caption=mcmod.info]
[
{
  "modid": "SRPmod",
  "name": "SRP Mod",
  "description": "World generation mod for SRP.",
  "version": "1.0",
  "mcversion": "1.6.4",
  "url": "",
  "updateUrl": "",
  "authors": ["Philip Hansen"],
  "credits": "",
  "logoFile": "",
  "screenshots": [],
  "dependencies": []
}
]
\end{lstlisting}
			\emph{mcmod.info} er en fil der str\ae ng taget ikke kr\ae ves, men den giver spillet en del informationer om vores \emph{mod}, som vises i spillet.
			Denne information er der mest af alt for at hj\ae lpe spilleren med at finde ud af hvad der er installeret.

			\begin{wrapfigure}{r}{0.5\textwidth}
				\includegraphics[keepaspectratio = true, width = 0.5\textwidth]{screenshot3}
				\caption{mcmod.info}
			\end{wrapfigure}
		\subsubsection{Iteration 2}
			Da vi nu har et fungerende mod, der kan k\o rers i spillet, kan vi forts\ae tte med implementeringen af den egentlige funktionalitet.

			For at holde styr p\aa \ koden, laver vi f\o rst en ny fil til at holde vores generations kode, den kaldes \emph{SRPWorldGenerator.java},
			derefter skal denne fil registeres som en generator, via \emph{forge}, det g\o res med f\o lgene kode

\begin{lstlisting}[label=SRPMod2,caption=SRPMod.java]
    public static SRPWorldGenerator worldGen = new SRPWorldGenerator();
    
    @EventHandler
    public void init(FMLInitializationEvent event)
    {
        GameRegistry.registerWorldGenerator(worldGen);
    }
}
\end{lstlisting}
	
			For at teste at det virker som \o nsket, har jeg kopieret noget test kode, der generere tr\ae \ blokke,
			rund omkring i verdenen.

\begin{lstlisting}[label=SRPWorldGenerator,caption=SRPWorldGenerator.java]
package dk.philiphansen.srpmod;

import java.util.Random;

import net.minecraft.world.World;
import net.minecraft.world.chunk.IChunkProvider;
import cpw.mods.fml.common.IWorldGenerator;

public class SRPWorldGenerator implements IWorldGenerator {

    @Override
    public void generate(Random random, int chunkX, int chunkZ, World world, IChunkProvider chunkGenerator, IChunkProvider chunkProvider) {
        world.setBlock(chunkX*16 + random.nextInt(16), 100, chunkZ*16 + random.nextInt(16), 5);
    }
}
\end{lstlisting}

			Da funktionen \emph{generate} kaldes med \emph{X, Y} v\ae rdien af den chunk der genereres, kan
			denne ganges med 16 (da enhver chunk er \(16 * 16\) blokke, dette giver hj\o rnet p\aa \ den givne chunk.
			Ved derefter at ligge et random tal mellem 0 og 16 til, f\aa r vi en blok med \emph{Y} koordinated 100, og et random \emph{X, Y}
			koordinat i hver chunk.

			\begin{wrapfigure}{r}{0.5\textwidth}
				\includegraphics[keepaspectratio = true, width = 0.5\textwidth]{screenshot4}
				\caption{F\o rste generations eksperiment}
			\end{wrapfigure}

			Med et stabilt grundlag for at generere blokke, forts\ae tter vi mod at generere den forskrevne funktion.

		\subsubsection{Iteration 3}
			
	\subsection{Vurdering}
	\section{Perspektivering}
\end{document}